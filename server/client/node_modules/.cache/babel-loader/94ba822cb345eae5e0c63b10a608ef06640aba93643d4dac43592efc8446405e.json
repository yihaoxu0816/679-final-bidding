{"ast":null,"code":"import { getUsers } from './users.js';\nimport { handleGet, handlePost, handleDelete, handlePatch } from './api.js';\n\n// Backend API URL - override the default from api.js\nconst API_URL = process.env.REACT_APP_API_URL || 'https://localhost:6790';\nconst POSTS_ENDPOINT = `${API_URL}/posts`;\nconst USERS_ENDPOINT = `${API_URL}/users`;\n\n/**\n * NOTE: You do not need to change this function! \n * If your implementations of getPosts() and getUsers()\n * are working, this function will work just fine.\n * \n * Get all posts with author names added (as opposed to just author ids)\n * @param {number} author (optional) - The author ID to filter posts by.\n * @returns {Promise<Object[]>} - An array of post objects with author names.\n */\nconst getPostsWithAuthorNames = async (authorId = null) => {\n  let posts = await getPosts(authorId);\n  let users = await getUsers();\n  return posts.map(post => {\n    var _user$displayName;\n    const user = users.find(user => user.id === post.authorId);\n    if (!user) {\n      throw new Error(`Post ${post.id} found with uknown author ${post.authorId}`);\n    }\n    return {\n      ...post,\n      authorName: (_user$displayName = user === null || user === void 0 ? void 0 : user.displayName) !== null && _user$displayName !== void 0 ? _user$displayName : 'Unknown Author'\n    };\n  });\n};\n\n/**\n * NOTE: You do not need to change this function! \n * If your implementations of getPost() and getUsers()\n * are working, this function will work just fine.\n * \n * Get a single post with author name added (as opposed to just author id)\n * @param {String} postId - The post to get.\n * @returns {Promise<Object>} - A post object with author name added.\n */\nconst getPostWithAuthorName = async postId => {\n  var _theAuthor$displayNam;\n  let users = await getUsers();\n  let thePost = await getPost(postId);\n  if (!thePost) {\n    throw new Error(`Post ${postId} not found.`);\n  }\n  let theAuthor = users.find(user => user.id === thePost.authorId);\n  if (!theAuthor) {\n    throw new Error(`Post ${thePost.id} has unknown author ${thePost.authorId}`);\n  }\n  thePost.authorName = (_theAuthor$displayNam = theAuthor === null || theAuthor === void 0 ? void 0 : theAuthor.displayName) !== null && _theAuthor$displayNam !== void 0 ? _theAuthor$displayNam : 'Unknown Author';\n  return thePost;\n};\n\n/**\n * NOTE: You do not need to change this function! \n * If your implementations of getPosts() and deletePost()\n * are working, this function will work just fine.\n * \n * Delete all posts by a user. Needed when a user is deleted.\n * @param {String} postId - The post to get.\n * @returns {Promise<Object>} - A post object with author name added.\n */\nconst deletePostsByUser = async userId => {\n  const postsByUser = await getPosts(userId);\n  postsByUser.forEach(async post => {\n    await deletePost(post.id);\n  });\n};\n\n/**\n * Get all posts.\n * If an author is provided, it will return only posts by that author.\n * @param {String} author (optional) - The author ID to filter posts by.\n * @returns {Promise<Object[]>} - An array of post objects.\n */\nconst getPosts = async (authorId = null) => {\n  if (authorId) {\n    // Get posts by a specific user\n    return await handleGet(`${USERS_ENDPOINT}/${authorId}/posts`);\n  }\n  // Get all posts\n  return await handleGet(POSTS_ENDPOINT);\n};\n\n/**\n * Get a post by its ID.\n * @param {String} id - The ID of the post to get.\n * @returns {Promise<Object>} - The post object if found, undefined otherwise\n */\nconst getPost = async id => {\n  const allPosts = await handleGet(POSTS_ENDPOINT);\n  return allPosts.find(post => post.id === id);\n};\n\n/**\n * Create a new (blog) post.\n * @param {Object} postData - The post data to create.\n * @returns {Promise<Object>} - The created post object.\n */\nconst createPost = async postData => {\n  // Backend automatically adds createdAt and updatedAt\n  await handlePost(`${USERS_ENDPOINT}/${postData.authorId}/posts`, postData);\n  // Fetch the updated posts list to get the newly created post\n  const posts = await getPosts(postData.authorId);\n  // Return the most recently created post (should be last in array or have latest timestamp)\n  return posts[posts.length - 1];\n};\n\n/**\n * Update a post.\n * @param {String} id - The ID of the post to update.\n * @param {Object} updatedFields - The fields to update.\n * @returns {Promise<Object>} - The updated post object.\n *   Fields not included in the object will not be updated.\n * @throws {Error} - if post not found\n */\nconst updatePost = async (id, updatedFields) => {\n  const thePost = postCollection.find(post => post.id === id);\n  if (!thePost) {\n    throw new Error(`Can't update post. Post with id ${id} not found.`);\n  }\n  const updatedPost = {\n    ...thePost,\n    ...updatedFields,\n    updatedAt: new Date().toISOString()\n  };\n  postCollection = postCollection.map(post => post.id === id ? updatedPost : post);\n  return updatedPost;\n};\n\n/**\n * Delete a post.\n * @param {String} id - The ID of the post to delete.\n * @returns {Promise<void>} - A promise that resolves when the post is deleted.\n */\nconst deletePost = async id => {\n  postCollection = postCollection.filter(post => post.id !== id);\n};\nexport { getPostsWithAuthorNames, getPostWithAuthorName, deletePostsByUser, getPosts, getPost, createPost, updatePost, deletePost };","map":{"version":3,"names":["getUsers","handleGet","handlePost","handleDelete","handlePatch","API_URL","process","env","REACT_APP_API_URL","POSTS_ENDPOINT","USERS_ENDPOINT","getPostsWithAuthorNames","authorId","posts","getPosts","users","map","post","_user$displayName","user","find","id","Error","authorName","displayName","getPostWithAuthorName","postId","_theAuthor$displayNam","thePost","getPost","theAuthor","deletePostsByUser","userId","postsByUser","forEach","deletePost","allPosts","createPost","postData","length","updatePost","updatedFields","postCollection","updatedPost","updatedAt","Date","toISOString","filter"],"sources":["/Users/andyxu/Desktop/fall2025/si679/proj-1-blogtastic-yihaoxu0816/client/src/data/posts.js"],"sourcesContent":["import { getUsers } from './users.js';\nimport { handleGet, handlePost, handleDelete, handlePatch } from './api.js';\n\n// Backend API URL - override the default from api.js\nconst API_URL = process.env.REACT_APP_API_URL || 'https://localhost:6790';\nconst POSTS_ENDPOINT = `${API_URL}/posts`;\nconst USERS_ENDPOINT = `${API_URL}/users`;\n\n/**\n * NOTE: You do not need to change this function! \n * If your implementations of getPosts() and getUsers()\n * are working, this function will work just fine.\n * \n * Get all posts with author names added (as opposed to just author ids)\n * @param {number} author (optional) - The author ID to filter posts by.\n * @returns {Promise<Object[]>} - An array of post objects with author names.\n */\nconst getPostsWithAuthorNames = async (authorId = null) => {\n  let posts = await getPosts(authorId);\n  let users = await getUsers();\n\n  return posts.map((post) => {\n    const user = users.find((user) => user.id === post.authorId);\n    if (!user) {\n      throw new Error(`Post ${post.id} found with uknown author ${post.authorId}`);\n    }\n    return {\n      ...post,\n      authorName: user?.displayName ?? 'Unknown Author'\n    };\n  });\n};\n\n/**\n * NOTE: You do not need to change this function! \n * If your implementations of getPost() and getUsers()\n * are working, this function will work just fine.\n * \n * Get a single post with author name added (as opposed to just author id)\n * @param {String} postId - The post to get.\n * @returns {Promise<Object>} - A post object with author name added.\n */\nconst getPostWithAuthorName = async (postId) => {\n  let users = await getUsers();\n  let thePost = await getPost(postId);\n  \n  if (!thePost) {\n    throw new Error(`Post ${postId} not found.`);\n  }\n\n  let theAuthor = users.find(user => user.id === thePost.authorId);\n  if (!theAuthor) {\n    throw new Error(`Post ${thePost.id} has unknown author ${thePost.authorId}`);\n  }\n\n  thePost.authorName = theAuthor?.displayName ?? 'Unknown Author';\n  return thePost;\n}\n\n/**\n * NOTE: You do not need to change this function! \n * If your implementations of getPosts() and deletePost()\n * are working, this function will work just fine.\n * \n * Delete all posts by a user. Needed when a user is deleted.\n * @param {String} postId - The post to get.\n * @returns {Promise<Object>} - A post object with author name added.\n */\nconst deletePostsByUser = async (userId) => {\n  const postsByUser = await getPosts(userId);\n  postsByUser.forEach(async post => {\n    await deletePost(post.id);\n  })\n}\n\n/**\n * Get all posts.\n * If an author is provided, it will return only posts by that author.\n * @param {String} author (optional) - The author ID to filter posts by.\n * @returns {Promise<Object[]>} - An array of post objects.\n */\nconst getPosts = async (authorId = null) => {\n  if (authorId) {\n    // Get posts by a specific user\n    return await handleGet(`${USERS_ENDPOINT}/${authorId}/posts`);\n  }\n  // Get all posts\n  return await handleGet(POSTS_ENDPOINT);\n};\n\n/**\n * Get a post by its ID.\n * @param {String} id - The ID of the post to get.\n * @returns {Promise<Object>} - The post object if found, undefined otherwise\n */\nconst getPost = async (id) => {\n  const allPosts = await handleGet(POSTS_ENDPOINT);\n  return allPosts.find(post => post.id === id);\n};\n\n/**\n * Create a new (blog) post.\n * @param {Object} postData - The post data to create.\n * @returns {Promise<Object>} - The created post object.\n */\nconst createPost = async (postData) => {\n  // Backend automatically adds createdAt and updatedAt\n  await handlePost(`${USERS_ENDPOINT}/${postData.authorId}/posts`, postData);\n  // Fetch the updated posts list to get the newly created post\n  const posts = await getPosts(postData.authorId);\n  // Return the most recently created post (should be last in array or have latest timestamp)\n  return posts[posts.length - 1];\n};\n\n/**\n * Update a post.\n * @param {String} id - The ID of the post to update.\n * @param {Object} updatedFields - The fields to update.\n * @returns {Promise<Object>} - The updated post object.\n *   Fields not included in the object will not be updated.\n * @throws {Error} - if post not found\n */\nconst updatePost = async(id, updatedFields) => {\n  const thePost = postCollection.find(post => post.id === id);\n  \n  if (!thePost) {\n    throw new Error(`Can't update post. Post with id ${id} not found.`);\n  }\n    \n  const updatedPost = {\n    ...thePost,\n    ...updatedFields,\n    updatedAt: new Date().toISOString(),\n  };\n  postCollection = postCollection.map(post => post.id === id ? updatedPost : post);\n  return updatedPost;\n};\n\n/**\n * Delete a post.\n * @param {String} id - The ID of the post to delete.\n * @returns {Promise<void>} - A promise that resolves when the post is deleted.\n */\nconst deletePost = async(id) => {\n  postCollection = postCollection.filter(post => post.id !== id);\n};\n\nexport { \n  getPostsWithAuthorNames,\n  getPostWithAuthorName,\n  deletePostsByUser,\n  getPosts, \n  getPost, \n  createPost, \n  updatePost, \n  deletePost, \n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}